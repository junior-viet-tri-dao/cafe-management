<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout}">
<head>
  <meta charset="UTF-8">
  <title>Danh s√°ch khuy·∫øn m√£i</title>
</head>
<body>
<div layout:fragment="content">
  <div class="bg-white shadow-xl rounded-xl p-6 mt-6 max-w-6xl mx-auto">
    <h2 class="text-2xl font-bold text-[#4e342e] mb-6">üì¢ Danh s√°ch khuy·∫øn m√£i</h2>

    <div class="overflow-x-auto">
      <table class="min-w-full table-auto border border-gray-300 rounded-lg">
        <thead class="bg-[#e3f2fd] text-gray-800 text-sm font-bold uppercase">
        <tr>
          <th class="px-4 py-2 text-center">Stt</th>
          <th class="px-4 py-2 text-left">T√™n khuy·∫øn m√£i</th>
          <th class="px-4 py-2 text-center">Ng√†y b·∫Øt ƒë·∫ßu</th>
          <th class="px-4 py-2 text-center">Ng√†y k·∫øt th√∫c</th>
          <th class="px-4 py-2 text-right">% Gi·∫£m gi√°</th>
          <th class="px-4 py-2 text-center">Thao t√°c</th>
        </tr>
        </thead>
        <tbody class="text-sm text-gray-700 divide-y divide-gray-100" th:if="${promotions != null}">
        <tr th:each="promo, iterStat : ${promotions}" class="hover:bg-yellow-50 transition">
          <td class="px-4 py-2 text-center" th:text="${iterStat.index + 1}">1</td>
          <td class="px-4 py-2" th:text="${promo.tenKhuyenMai}">Khai tr∆∞∆°ng qu√°n</td>
          <td class="px-4 py-2 text-center" th:text="${#temporals.format(promo.ngayBatDau, 'dd/MM/yyyy')}">21/01/2015</td>
          <td class="px-4 py-2 text-center" th:text="${#temporals.format(promo.ngayKetThuc, 'dd/MM/yyyy')}">21/01/2015</td>
          <td class="px-4 py-2 text-right" th:text="${promo.giaTriGiam} + '%'">50%</td>
          <td class="px-4 py-2 text-center flex justify-center gap-2">
            <a th:href="@{/marketing/update/{id}(id=${promo.maKhuyenMai})}"
               class="bg-yellow-400 hover:bg-yellow-500 text-white text-xs font-semibold px-3 py-1 rounded shadow">
              ‚úèÔ∏è S·ª≠a
            </a>

            <form th:action="@{/marketing/delete/{id}(id=${promo.maKhuyenMai})}" method="post"
                  th:id="'deleteForm-' + ${promo.maKhuyenMai}">
              <button type="button"
                      th:attr="data-id=${promo.maKhuyenMai}"
                      class="btn-delete bg-red-500 hover:bg-red-600 text-white text-xs font-semibold px-3 py-1 rounded shadow">
                üóëÔ∏è X√≥a
              </button>
            </form>
          </td>
        </tr>
        </tbody>
        <tbody th:if="${promotions == null or promotions.size() == 0}">
        <tr>
          <td colspan="6" class="text-center text-gray-400 py-6">Kh√¥ng c√≥ khuy·∫øn m√£i n√†o.</td>
        </tr>
        </tbody>
      </table>
    </div>
  </div>
  <script>
    document.querySelectorAll('.btn-delete').forEach(button => {
      button.addEventListener('click', function () {
        const id = this.getAttribute('data-id');
        Swal.fire({
          title: 'X√°c nh·∫≠n xo√°?',
          text: 'B·∫°n c√≥ ch·∫Øc mu·ªën xo√° khuy·∫øn m√£i n√†y?',
          icon: 'question',
          showCancelButton: true,
          confirmButtonText: 'C√≥',
          cancelButtonText: 'Kh√¥ng',
          confirmButtonColor: '#16a34a',
          cancelButtonColor: '#ef4444'
        }).then((result) => {
          if (result.isConfirmed) {
            document.getElementById('deleteForm-' + id).submit();
          }
        });
      });
    });
  </script>
</div>
</body>
</html>

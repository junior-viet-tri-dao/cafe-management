<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout}">
<head>
    <meta charset="UTF-8">
    <title>Ch·ªânh s·ª≠a m√≥n</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        function addIngredientRow() {
            const container = document.getElementById("ingredients");
            const index = container.children.length;
            const row = document.createElement("div");
            row.classList.add("flex", "gap-2", "mb-2");
            row.innerHTML = `
                <input name="ingredients[${index}].productName" placeholder="T√™n th√†nh ph·∫ßn" required maxlength="50"
                    class="border px-2 py-1 rounded w-1/3" />
                <input name="ingredients[${index}].quantity" type="number" step="0.01" min="0.01" required
                    placeholder="Kh·ªëi l∆∞·ª£ng" class="border px-2 py-1 rounded w-1/4" />
                <input name="ingredients[${index}].unitName" placeholder="ƒê∆°n v·ªã t√≠nh" required maxlength="10"
                    class="border px-2 py-1 rounded w-1/4" />
                <button type="button" onclick="this.parentElement.remove()"
                    class="text-red-600 hover:underline">X√≥a</button>
            `;
            container.appendChild(row);
        }
    </script>
</head>
<body class="bg-gray-100">
<div layout:fragment="content" class="max-w-3xl mx-auto mt-8 bg-white p-6 rounded shadow">

    <h2 class="text-2xl font-bold text-blue-600 mb-6">‚úèÔ∏è Ch·ªânh s·ª≠a m√≥n</h2>

    <form th:action="@{'/menu/edit/' + ${menuItem.id}}" method="post" th:object="${menuItem}" class="space-y-4">

        <!-- T√™n m√≥n -->
        <div>
            <label class="block font-semibold mb-1">T√™n m√≥n:</label>
            <input type="text" th:field="*{itemName}" required maxlength="100" placeholder="C√† ph√™ s·ªØa"
                   class="w-full border px-3 py-2 rounded" />
            <div th:if="${#fields.hasErrors('itemName')}" th:errors="*{itemName}" class="text-red-600 text-sm mt-1"></div>
        </div>

        <!-- Gi√° ti·ªÅn -->
        <div>
            <label class="block font-semibold mb-1">Gi√° ti·ªÅn:</label>
            <input type="number" th:field="*{currentPrice}" step="1000" min="1000" required
                   class="w-full border px-3 py-2 rounded" />
            <div th:if="${#fields.hasErrors('currentPrice')}" th:errors="*{currentPrice}" class="text-red-600 text-sm mt-1"></div>
        </div>

        <!-- Th√†nh ph·∫ßn -->
        <div>
            <h4 class="text-lg font-semibold mb-2">ü•£ Th√†nh ph·∫ßn</h4>
            <div id="ingredients" class="space-y-2">
                <div th:each="ingredient, iStat : *{ingredients}" class="flex gap-2">
                    <input type="text" th:name="'ingredients[' + ${iStat.index} + '].productName'"
                           th:value="${ingredient.productName}" required maxlength="50"
                           placeholder="T√™n th√†nh ph·∫ßn" class="border px-2 py-1 rounded w-1/3" />
                    <input type="number" step="0.01" min="0.01" required
                           th:name="'ingredients[' + ${iStat.index} + '].quantity'"
                           th:value="${ingredient.quantity}" placeholder="Kh·ªëi l∆∞·ª£ng"
                           class="border px-2 py-1 rounded w-1/4" />
                    <input type="text" required maxlength="10" placeholder="ƒê∆°n v·ªã t√≠nh"
                           th:name="'ingredients[' + ${iStat.index} + '].unitName'"
                           th:value="${ingredient.unitName}" class="border px-2 py-1 rounded w-1/4" />
                    <button type="button" onclick="this.parentElement.remove()"
                            class="text-red-600 hover:underline">X√≥a</button>
                </div>
            </div>

            <button type="button" onclick="addIngredientRow()"
                    class="mt-3 text-sm text-blue-600 hover:underline">+ Th√™m th√†nh ph·∫ßn</button>
        </div>

        <!-- H√†nh ƒë·ªông -->
        <div class="flex justify-end gap-4 mt-6">
            <a th:href="@{/menu}" class="bg-gray-300 hover:bg-gray-400 text-gray-800 px-4 py-2 rounded">‚ùå H·ªßy</a>
            <button type="submit" class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded">‚úÖ C·∫≠p nh·∫≠t</button>
        </div>
    </form>

</div>
</body>
</html>

<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout}">
<head>
    <meta charset="UTF-8">
    <title>Káº¿t quáº£ thanh toÃ¡n</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 text-gray-800">
<div layout:fragment="content" class="max-w-2xl mx-auto bg-white p-6 rounded-lg shadow mt-10">

    <h2 class="text-2xl font-bold text-blue-700 mb-6">ğŸ“„ Káº¿t quáº£ thanh toÃ¡n</h2>

    <!-- âœ… ThÃ nh cÃ´ng -->
    <div th:if="${response.success}" class="bg-green-50 border-l-4 border-green-500 text-green-700 p-4 rounded mb-6">
        <p class="font-semibold text-lg mb-2">âœ… Thanh toÃ¡n thÃ nh cÃ´ng!</p>
        <ul class="space-y-1 pl-4 list-disc">
            <li><b>Tá»•ng tiá»n:</b>
                <span th:text="${#numbers.formatDecimal(response.totalAmount, 0, 'COMMA', 0, 'POINT')} + ' VND'">0 VND</span>
            </li>
            <li><b>KhÃ¡ch Ä‘Æ°a:</b>
                <span th:text="${#numbers.formatDecimal(response.customerCash, 0, 'COMMA', 0, 'POINT')} + ' VND'">0 VND</span>
            </li>
            <li><b>Tiá»n thá»‘i láº¡i:</b>
                <span th:text="${#numbers.formatDecimal(response.change, 0, 'COMMA', 0, 'POINT')} + ' VND'">0 VND</span>
            </li>
            <li><b>HÃ³a Ä‘Æ¡n ID:</b>
                <span th:text="${response.invoiceId}">---</span>
            </li>
            <li><b>Tráº¡ng thÃ¡i hÃ³a Ä‘Æ¡n:</b>
                <span th:text="${response.invoiceStatus}">---</span>
            </li>
            <li><b>NhÃ¢n viÃªn thanh toÃ¡n:</b>
                <span th:text="${response.paidByName}">KhÃ´ng rÃµ</span>
                (ID: <span th:text="${response.paidById}">-</span>)
            </li>
        </ul>
    </div>

    <!-- âŒ Tháº¥t báº¡i -->
    <div th:if="${!response.success}" class="bg-red-50 border-l-4 border-red-500 text-red-700 p-4 rounded mb-6">
        <p class="font-semibold text-lg mb-2">âŒ Thanh toÃ¡n tháº¥t báº¡i</p>
        <p><b th:text="${response.message}">Lá»—i khÃ´ng xÃ¡c Ä‘á»‹nh</b></p>
    </div>

    <!-- Quay láº¡i -->
    <a href="/sale"
       class="inline-block mt-4 text-blue-600 hover:text-blue-800 hover:underline transition">
        â† Quay láº¡i danh sÃ¡ch bÃ n
    </a>

    <!-- In hÃ³a Ä‘Æ¡n -->
    <a th:if="${response.success}"
       th:href="@{'/sale/' + ${tableId} + '/print'}"
       target="_blank"
       id="print-button"
       class="inline-block mt-4 ml-6 text-green-600 hover:text-green-800 hover:underline transition">
        ğŸ–¨ In hÃ³a Ä‘Æ¡n
    </a>

</div>

<!-- Script láº¯ng nghe tÃ­n hiá»‡u tá»« cá»­a sá»• in -->
<script>
    window.addEventListener('message', function(event) {
        if (event.data === 'printed') {
            alert("ğŸ–¨ ÄÃ£ in hÃ³a Ä‘Æ¡n thÃ nh cÃ´ng!");
        }
    });
</script>

</body>
</html>

<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout}">
<head>
    <meta charset="UTF-8">
    <title>Trang Tìm Kiếm Nhân Viên </title>


    <style>


        /* --- CSS cho Form Tìm kiếm --- */
        .search-form-container {
            background-color: #ffffff;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
        }

        .search-form-container h2 {
            margin-top: 0;
            margin-bottom: 20px;
            color: #333;
            font-size: 1.5em;
            border-bottom: 1px solid #eee;
            padding-bottom: 10px;
        }

        .search-fields {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .search-field-group {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .search-field-group label {
            flex-shrink: 0;
            width: 80px;
            text-align: right;
            color: #555;
            font-size: 0.95em;
        }

        .search-field-group input[type="text"],
        .search-field-group select {
            flex-grow: 1;
            padding: 8px 12px;
            border: 1px solid #c8d8e5;
            border-radius: 5px;
            font-size: 0.95em;
            box-sizing: border-box;
            background-color: #fefefe;
        }

        .search-field-group input[type="text"]::placeholder {
            color: #999;
        }

        .search-buttons {
            text-align: right;
            padding-top: 10px;
            border-top: 1px solid #eee;
        }

        .search-buttons button {
            padding: 10px 25px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1em;
            transition: background-color 0.3s ease;
        }
        .search-buttons button:hover {
            background-color: #0056b3;
        }
        .search-buttons button:active {
            background-color: #004085;
        }

        /* --- CSS cho Bảng Kết quả --- */
        .table-container {
            border: 1px solid #ddd;
            margin-top: 20px;
            display: flex;
            flex-direction: column;
            background-color: #ffffff;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
        }

        .table-header {
            display: flex;
            background-color: #e9ecef;
            font-weight: bold;
        }

        .table-row {
            display: flex !important;
        }

        .table-cell, .table-header-cell {
            padding: 10px 8px;
            box-sizing: border-box;
            border: 1px solid #e0e0e0;
            display: flex;
            align-items: center;
            justify-content: flex-start;
        }

        /* Điều chỉnh border để chúng không bị trùng lặp không cần thiết */
        .table-header-cell:not(:last-child) {
            border-right: none;
        }
        .table-cell:not(:last-child) {
            border-right: none;
        }

        .table-header-cell {
            border-bottom: none;
        }

        /* Viền trên cùng cho hàng dữ liệu đầu tiên */
        .table-row:first-of-type .table-cell {
            border-top: 1px solid #e0e0e0;
        }

        /* Tùy chỉnh chiều rộng cho từng cột (Không còn cột select-col) */
        .table-header-cell.name, .table-cell.name {
            flex: 2.5;
        }
        .table-header-cell.position, .table-cell.position {
            flex: 1.5;
        }
        .table-header-cell.salary, .table-cell.salary {
            flex: 1;
            text-align: right;
            justify-content: flex-end;
        }

        .table-header-cell {
            cursor: pointer;
            user-select: none;
            position: relative;
        }
        .table-header-cell:hover { /* Bỏ :not(.select-col) vì không còn cột đó */
            background-color: #e0e0e0;
        }
        .sort-arrow {
            display: inline-block;
            margin-left: 5px;
            min-width: 10px;
            color: #666;
        }

        /* Bỏ highlight hàng khi checkbox được chọn vì không còn checkbox */
        /* .table-row.selected {
            background-color: #e6f7ff;
        } */

        /* --- Không còn nút xóa và popup xác nhận --- */
        /* Các style liên quan đến .delete-button-container, .delete-button, .popup-overlay, .popup-box, .popup-buttons đã bị xóa */
    </style>



</head>
<body>

<div layout:fragment="content">



    <form id="searchForm">
        <div class="search-fields">
            <div class="search-field-group">
                <label for="searchName">Họ tên:</label>
                <input type="text" id="searchName" name="searchName" placeholder="Nhập họ và tên">
            </div>

            <div class="search-field-group">
                <label for="searchPosition">Chức vụ:</label>
                <select id="searchPosition" name="searchPosition">
                    <option value="">Tất cả</option>
                    <option value="Trưởng phòng">Trưởng phòng</option>
                    <option value="Nhân viên">Nhân viên</option>
                    <option value="Giám đốc">Giám đốc</option>
                    <option value="Kế toán">Kế toán</option>
                    <option value="Thư ký">Thư ký</option>
                    <option value="Trưởng nhóm">Trưởng nhóm</option>
                    <option value="Thực tập sinh">Thực tập sinh</option>
                    <option value="Chuyên viên">Chuyên viên</option>
                </select>
            </div>

            <div class="search-field-group">
                <label for="searchSalaryMin">Lương từ:</label>
                <input type="text" id="searchSalaryMin" name="searchSalaryMin" placeholder="Lương tối thiểu">
            </div>

            <div class="search-field-group">
                <label for="searchSalaryMax">Đến:</label>
                <input type="text" id="searchSalaryMax" name="searchSalaryMax" placeholder="Lương tối đa">
            </div>
        </div>
        <div class="search-buttons">
            <button type="submit">Tìm kiếm</button>
        </div>
    </form>
</div>

<h2>Danh sách Nhân viên</h2>
<div class="table-container" id="employeeTable">
    <div class="table-header">
        <div class="table-header-cell name" data-sort-by="name">Họ tên <span class="sort-arrow"></span></div>
        <div class="table-header-cell position" data-sort-by="position">Chức vụ <span class="sort-arrow"></span></div>
        <div class="table-header-cell salary" data-sort-by="salary">Lương <span class="sort-arrow"></span></div>
    </div>

</div>

<script>
    // Dữ liệu nhân viên gốc (để tìm kiếm)
    const allEmployeesData = [
        { name: "Nguyễn Văn A", position: "Trưởng phòng", salary: 25000000 },
        { name: "Trần Thị B", position: "Nhân viên", salary: 12000000 },
        { name: "Lê Văn C", position: "Giám đốc", salary: 40000000 },
        { name: "Phạm Thị D", position: "Kế toán", salary: 15000000 },
        { name: "Hoàng Văn E", position: "Trưởng nhóm", salary: 18000000 },
        { name: "Đỗ Thị F", position: "Thực tập sinh", salary: 5000000 },
        { name: "Vũ Văn G", position: "Chuyên viên", salary: 20000000 },
        { name: "Ngô Thị H", position: "Thư ký", salary: 10000000 },
        { name: "Đặng Thị K", position: "Nhân viên", salary: 13000000 },
        { name: "Phan Văn L", position: "Trưởng phòng", salary: 27000000 },
        { name: "Mai Thị M", position: "Kế toán", salary: 16500000 }
    ];

    let currentDisplayedEmployees = [...allEmployeesData];
    let currentSortColumn = null;
    let currentSortDirection = 'asc';

    // --- DOM Elements ---
    const employeeTable = document.getElementById('employeeTable');
    const headerCells = document.querySelectorAll('.table-header-cell');

    // Search Form Elements
    const searchForm = document.getElementById('searchForm');
    const searchNameInput = document.getElementById('searchName');
    const searchPositionSelect = document.getElementById('searchPosition');
    const searchSalaryMinInput = document.getElementById('searchSalaryMin');
    const searchSalaryMaxInput = document.getElementById('searchSalaryMax');

    // --- Helper Functions ---

    // Hàm tạo một hàng bảng từ dữ liệu nhân viên (Đã bỏ checkbox)
    function createTableRow(employee) {
        const rowDiv = document.createElement('div');
        rowDiv.classList.add('table-row');

        // Cột Họ tên
        const nameCol = document.createElement('div');
        nameCol.classList.add('table-cell', 'name');
        nameCol.textContent = employee.name;
        rowDiv.appendChild(nameCol);

        // Cột Chức vụ
        const positionCol = document.createElement('div');
        positionCol.classList.add('table-cell', 'position');
        positionCol.textContent = employee.position;
        rowDiv.appendChild(positionCol);

        // Cột Lương
        const salaryCol = document.createElement('div');
        salaryCol.classList.add('table-cell', 'salary');
        salaryCol.textContent = employee.salary.toLocaleString('vi-VN') + ' VNĐ';
        salaryCol.dataset.value = employee.salary; // Lưu giá trị số để sắp xếp
        rowDiv.appendChild(salaryCol);

        return rowDiv;
    }

    // Hàm điền dữ liệu vào bảng
    function populateTable(data) {
        // Xóa tất cả các hàng cũ (trừ header)
        const existingRows = employeeTable.querySelectorAll('.table-row');
        existingRows.forEach(row => row.remove());

        // Thêm các hàng mới
        const fragment = document.createDocumentFragment();
        data.forEach(employee => {
            fragment.appendChild(createTableRow(employee));
        });
        const header = employeeTable.querySelector('.table-header');
        employeeTable.insertBefore(fragment, header.nextSibling);
    }

    // Hàm sắp xếp bảng (logic giữ nguyên, nhưng index cột thay đổi do bỏ checkbox)
    function sortDivTable(dataToSort, columnIndex, direction) {
        const sortedData = [...dataToSort].sort((a, b) => {
            let valueA, valueB;

            // Ánh xạ index của headerCells với thuộc tính của đối tượng employee
            if (columnIndex === 0) { // Họ tên (trước đây là index 1)
                valueA = a.name;
                valueB = b.name;
            } else if (columnIndex === 1) { // Chức vụ (trước đây là index 2)
                valueA = a.position;
                valueB = b.position;
            } else if (columnIndex === 2) { // Lương (trước đây là index 3)
                valueA = a.salary;
                valueB = b.salary;
            } else {
                return 0; // Trường hợp không xác định hoặc lỗi
            }

            if (typeof valueA === 'string') {
                valueA = valueA.toLowerCase();
                valueB = valueB.toLowerCase();
            }

            if (valueA < valueB) {
                return direction === 'asc' ? -1 : 1;
            }
            if (valueA > valueB) {
                return direction === 'asc' ? 1 : -1;
            }
            return 0;
        });
        return sortedData;
    }

    // --- Event Listeners ---

    // Lắng nghe sự kiện click trên các tiêu đề cột để sắp xếp
    headerCells.forEach((header, index) => {
        // Không cần kiểm tra class 'select-col' vì nó đã bị bỏ
        header.addEventListener('click', () => {
            const column = header.dataset.sortBy;
            let direction;

            if (currentSortColumn === column) {
                currentSortDirection = currentSortDirection === 'asc' ? 'desc' : 'asc';
            } else {
                currentSortColumn = column;
                currentSortDirection = 'asc';
            }
            direction = currentSortDirection;

            // Xóa mũi tên sắp xếp cũ trên tất cả các tiêu đề
            document.querySelectorAll('.table-header-cell .sort-arrow').forEach(arrow => arrow.textContent = '');

            const sortArrow = header.querySelector('.sort-arrow');
            if (sortArrow) {
                if (direction === 'asc') {
                    sortArrow.textContent = '▲';
                } else {
                    sortArrow.textContent = '▼';
                }
            }

            currentDisplayedEmployees = sortDivTable(currentDisplayedEmployees, index, direction);
            populateTable(currentDisplayedEmployees);
        });
    });

    // --- Tìm kiếm Logic ---
    searchForm.addEventListener('submit', function(event) {
        event.preventDefault();

        const nameQuery = searchNameInput.value.toLowerCase().trim();
        const positionQuery = searchPositionSelect.value.toLowerCase();
        const salaryMin = parseFloat(searchSalaryMinInput.value.replace(/\./g, '')) || 0;
        const salaryMax = parseFloat(searchSalaryMaxInput.value.replace(/\./g, '')) || Infinity;

        const filteredData = allEmployeesData.filter(employee => {
            const matchesName = nameQuery === '' || employee.name.toLowerCase().includes(nameQuery);
            const matchesPosition = positionQuery === '' || employee.position.toLowerCase() === positionQuery;
            const matchesSalary = employee.salary >= salaryMin && employee.salary <= salaryMax;

            return matchesName && matchesPosition && matchesSalary;
        });

        currentDisplayedEmployees = filteredData;
        populateTable(currentDisplayedEmployees);
    });

    // --- Initialization ---
    populateTable(allEmployeesData);
</script>


</div>
</body>
</html>

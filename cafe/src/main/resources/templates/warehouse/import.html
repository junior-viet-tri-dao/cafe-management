<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout}">
      
<head><title>Nhập hàng hóa</title></head>
<body>
<div layout:fragment="content">

<h2>Nhập hàng hóa</h2>

<!-- Hiển thị thông báo -->
<div th:if="${success}" style="color: green;" th:text="${success}"></div>
<div th:if="${error}" style="color: red;" th:text="${error}"></div>

<form th:action="@{/warehouse/import}" method="post" th:object="${importRequest}">
    <label>Tên hàng:</label>
    <select th:field="*{productId}" id="productSelect" onchange="updateUnitAndPrice()">
        <option th:each="product : ${products}" 
                th:value="${product.id}" 
                th:text="${product.productName}"
                th:data-unit="${product.unitName}"
                th:data-price="${product.productPrice}">
        </option>
    </select><br/>

    <label>Số lượng:</label>
    <input type="number" th:field="*{quantity}" min="1" required/><br/>

    <label>Đơn vị:</label>
    <input type="text" th:field="*{unitName}" id="unitName" required/><br/>

    <label>Đơn giá:</label>
    <input type="number" th:field="*{productPrice}" id="productPrice" required/><br/>

    <label>Ngày nhập:</label>
    <input type="date" th:field="*{importDate}" required/><br/>

    <button type="submit">Đồng ý</button>
    <a th:href="@{/warehouse}">Hủy</a>
</form>

<script>
    function updateUnitAndPrice() {
        const select = document.getElementById("productSelect");
        const selected = select.options[select.selectedIndex];
        document.getElementById("unitName").value = selected.getAttribute("data-unit") || "";
        document.getElementById("productPrice").value = selected.getAttribute("data-price") || "";
    }
    window.onload = updateUnitAndPrice;
</script>
</div>
</body>
</html>

<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Danh sách nhân viên - Quản lý cà phê</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 min-h-screen flex">

    <!-- SIDEBAR -->
    <div class="w-64 bg-white shadow-lg p-6">
        <h2 class="text-xl font-bold text-blue-600 mb-6">Quản lý Cà Phê</h2>
        <nav>
            <ul class="space-y-3">
                <li><a href="/home" class="text-gray-700 hover:text-blue-600">Trang chủ</a></li>
                <li><a href="/nhanvien" class="text-blue-600 font-semibold">Nhân viên</a></li>
                <li><a href="/ban" class="text-gray-700 hover:text-blue-600">Bán hàng</a></li>
                <li><a href="/thucdon" class="text-gray-700 hover:text-blue-600">Thực đơn</a></li>
                <!-- Add other links here -->
            </ul>
        </nav>
    </div>

    <!-- MAIN CONTENT -->
    <div class="flex-1 p-10">
        <h1 class="text-3xl font-bold text-gray-800 mb-6">Danh sách nhân viên</h1>

        <!-- Thông báo -->
        <p th:if="${success}" th:text="${success}" class="text-green-600 font-semibold mb-4"></p>
        <p th:if="${error}" th:text="${error}" class="text-red-600 font-semibold mb-4"></p>

        <!-- Nút thêm -->
        <a th:href="@{/nhanvien/add}" class="bg-blue-600 hover:bg-blue-700 text-white py-2 px-4 rounded mb-4 inline-block">
            + Thêm nhân viên
        </a>

        <!-- Form tìm kiếm -->
        <form th:action="@{/nhanvien/search}" method="get" class="mb-4">
            <input type="text" name="keyword" placeholder="Tìm theo tên hoặc chức vụ..."
                   class="border p-2 rounded w-64 mr-2">
            <button type="submit" class="bg-indigo-500 text-white px-4 py-2 rounded">Tìm</button>
        </form>

        <!-- Bảng danh sách -->
        <div class="bg-white shadow-md rounded overflow-x-auto">
            <table class="min-w-full table-auto">
                <thead class="bg-gray-100">
                    <tr>
                        <th class="px-4 py-2 text-left">Tên đăng nhập</th>
                        <th class="px-4 py-2 text-left">Họ tên</th>
                        <th class="px-4 py-2 text-left">Chức vụ</th>
                        <th class="px-4 py-2 text-left">Vai trò</th>
                        <th class="px-4 py-2 text-left">Lương</th>
                        <th class="px-4 py-2 text-left">Hành động</th>
                    </tr>
                </thead>
                <tbody>
                    <tr th:each="nv : ${list}" class="border-t">
                        <td class="px-4 py-2" th:text="${nv.user}"></td>
                        <td class="px-4 py-2" th:text="${nv.hoVaTen}"></td>
                        <td class="px-4 py-2" th:text="${nv.chucVu}"></td>
                        <td class="px-4 py-2" th:text="${nv.vaiTro} ?: 'Chưa có'"></td>
                        <td class="px-4 py-2" th:text="${nv.luong}"></td>
                        <td class="px-4 py-2 space-x-2">
                            <a th:href="@{'/nhanvien/edit/' + ${nv.user}}" class="text-blue-600 hover:underline">Sửa</a>

                            <!-- Chỉ cho xóa nếu không phải ADMIN -->
                            <form th:if="${nv.vaiTro != 'ADMIN'}" th:action="@{/nhanvien/xoa}" method="post" style="display:inline;">
                                <input type="hidden" name="username" th:value="${nv.user}" />
                                <button type="submit" class="text-red-600 hover:underline bg-transparent border-none p-0">Xóa</button>
                            </form>
                            <span th:if="${nv.vaiTro == 'ADMIN'}" class="text-gray-400">(Không thể xóa ADMIN)</span>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

</body>
</html>

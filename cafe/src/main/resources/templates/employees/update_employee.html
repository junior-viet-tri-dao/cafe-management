<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout}">
<head>
    <meta charset="UTF-8">
    <title>Chỉnh sửa nhân viên</title>
</head>
<body>
<div layout:fragment="content" class="bg-[#fefae0] min-h-screen w-full flex justify-center items-start py-12 px-4">
    <div class="w-full max-w-4xl bg-white p-10 rounded-2xl shadow-xl border border-gray-200">
        <h1 class="text-3xl font-bold text-[#3e2723] mb-10 text-center tracking-wide">Chỉnh sửa nhân viên</h1>

        <form th:action="@{'/employee/update'}" th:object="${employee}" method="post">
            <input type="hidden" th:field="*{id}"/>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                <!-- Cột trái -->
                <div class="space-y-6">
                    <div>
                        <label for="fullName" class="block text-[#3e2723] font-bold text-lg mb-2">* Họ tên:</label>
                        <input type="text" th:field="*{fullName}" id="fullName" required minlength="5"
                               class="w-full border border-gray-300 rounded-md px-4 py-3 text-base focus:ring focus:ring-yellow-400 focus:border-yellow-500 outline-none"/>
                    </div>

                    <div>
                        <label for="phoneNumber" class="block text-[#3e2723] font-bold text-lg mb-2">* Số điện thoại:</label>
                        <input type="text" th:field="*{phoneNumber}" id="phoneNumber" required
                               class="w-full border border-gray-300 rounded-md px-4 py-3 text-base focus:ring focus:ring-yellow-400 focus:border-yellow-500 outline-none"/>
                    </div>

                    <div>
                        <label for="address" class="block text-[#3e2723] font-bold text-lg mb-2">Địa chỉ:</label>
                        <input type="text" th:field="*{address}" id="address"
                               class="w-full border border-gray-300 rounded-md px-4 py-3 text-base focus:ring focus:ring-yellow-400 focus:border-yellow-500 outline-none"/>
                    </div>

                    <div>
                        <label for="imageUrl" class="block text-[#3e2723] font-bold text-lg mb-2">URL ảnh:</label>
                        <input type="text" th:field="*{imageUrl}" id="imageUrl"
                               class="w-full border border-gray-300 rounded-md px-4 py-3 text-base focus:ring focus:ring-yellow-400 focus:border-yellow-500 outline-none"/>
                    </div>
                </div>

                <!-- Cột phải -->
                <div class="space-y-6">
                    <!-- Chức vụ -->
                    <div>
                        <label for="positionId" class="block text-[#3e2723] font-bold text-lg mb-2">* Chức vụ:</label>
                        <select th:field="*{positionId}" id="positionId" required
                                class="w-full border border-gray-300 rounded-md px-4 py-3 text-base focus:ring focus:ring-yellow-400 focus:border-yellow-500 outline-none">
                            <option value="">-- Chọn chức vụ --</option>
                            <option th:each="position : ${positions}"
                                    th:value="${position.id}"
                                    th:text="${position.positionName}"
                                    th:attr="data-luong=${position.salary}">
                            </option>
                        </select>
                    </div>

                    <!-- Lương -->
                    <div>
                        <label for="salary" class="block text-[#3e2723] font-bold text-lg mb-2">Lương:</label>
                        <input type="text" id="salary" readonly placeholder="Tự động hiển thị"
                               class="w-full bg-gray-100 border border-gray-300 rounded-md px-4 py-3 text-base text-gray-700 font-semibold"/>
                    </div>

                    <!-- Username -->
                    <div>
                        <label for="username" class="block text-[#3e2723] font-bold text-lg mb-2">* Tên đăng nhập:</label>
                        <input type="text" th:field="*{username}" id="username" required minlength="3" readonly
                               class="w-full bg-gray-100 border border-gray-300 rounded-md px-4 py-3 text-base text-gray-600 font-semibold"/>
                    </div>

                    <!-- Password -->
                    <div>
                        <label for="password" class="block text-[#3e2723] font-bold text-lg mb-2">Mật khẩu mới:</label>
                        <input type="password" th:field="*{password}" id="password" minlength="6"
                               placeholder="Nhập mật khẩu mới (hoặc để trống)"
                               class="w-full border border-gray-300 rounded-md px-4 py-3 text-base focus:ring focus:ring-yellow-400 focus:border-yellow-500 outline-none"/>
                    </div>
                </div>
            </div>

            <!-- Nút hành động -->
            <div class="flex justify-between items-center mt-10">
                <a th:href="@{/employee}"
                   class="bg-gray-500 hover:bg-gray-600 text-white font-semibold px-6 py-2 rounded-md shadow">
                    Hủy
                </a>
                <button type="submit"
                        class="bg-yellow-500 hover:bg-yellow-600 text-white font-semibold px-6 py-2 rounded-md shadow">
                    Cập nhật
                </button>
            </div>
        </form>
    </div>

    <!-- Script cập nhật lương -->
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const positionSelect = document.getElementById('positionId');
            const salaryInput = document.getElementById('salary');

            function formatVND(number) {
                if (!number) return '';
                return new Intl.NumberFormat('vi-VN', {
                    style: 'currency',
                    currency: 'VND'
                }).format(Number(number));
            }

            function updateSalaryDisplay() {
                const selectedOption = positionSelect.options[positionSelect.selectedIndex];
                const salary = selectedOption.getAttribute('data-luong');
                salaryInput.value = salary ? formatVND(salary) : '';
            }

            if (positionSelect) {
                positionSelect.addEventListener('change', updateSalaryDisplay);
                updateSalaryDisplay(); // Load sẵn khi mở form
            }
        });
    </script>
</div>
</body>
</html>
